# See accompanying README.md for details about this file.
version: 2

config:
  log_level: INFO
  output_dir: ${OUTPUT_DIR} # this will be a parameter that is passed through from the command line, leave this as-is
  memory_limit: 1GB
  state_file: ${STATE_FILE}
  show_graph: False
  parameter_defaults:
    STUDENT_ID_NAME: 'edFi_studentUniqueID' # default to the column added by the apply_xwalk package of student ID xwalking feature
    POSSIBLE_STUDENT_ID_COLUMNS: tx_unique_student_id

sources:

  # SEEDS
  assessmentReportingMethodDescriptors:
    file: ../../seeds/assessmentReportingMethodDescriptors.csv
    header_rows: 1
  performanceLevelDescriptors:
    file: ../../seeds/performanceLevelDescriptors.csv
    header_rows: 1
  objectiveAssessments:
    file: ../../seeds/objectiveAssessments.csv
    header_rows: 1
  obj_assess_codes_xwalk:
    file: ../../seeds/obj_assess_codes_xwalk.csv
    header_rows: 1
  assessments:
    file: ../../seeds/assessments.csv
    header_rows: 1

  # INPUT STU ASSESSMENT FILES
  input:
    file: ${INPUT_FILE}
    header_rows: 0
    type: fixedwidth
    {% if ${API_YEAR} == "2024" %}

    {% elif ${API_YEAR} == "2022" %}
    columns:
      - administration_date
      - grade_level_code
      - esc_region_number
      - county_district_campus_number
      - district_name
      - campus_name
      - last_name
      - first_name
      - middle_initial
      - student_id
      - sex_code
      - date_of_birth
      - blank_14
      - hispanic_latino_code
      - american_indian_alaska_native_code
      - asian_code
      - black_african_american_code
      - native_hawaiian_pacific_islander_code
      - white_code
      - ethnicity/race_reporting_category
      - economic_disadvantage_code
      - title_i_part_a_indicator_code
      - migrant_indicator_code
      - blank_27
      - emergent_bilingual_indicator_code
      - bilingual_indicator_code
      - esl_indicator_code
      - blank_31
      - special_ed_indicator_code
      - blank_33
      - gifted_talented_indicator_code
      - at_risk_indicator_code
      - blank_36
      - local_student_id
      - blank_39
      - fall_2021_tsds_peims_county_district_campus_number
      - blank_42
      - fall_2021_tsds_peims_studentattribution_code
      - student_portal_unique_accesscode
      - migrant_student_in_texas_migrantinterstate_program_(tmip)
      - fall_2021_tsds_peims_military_connected_student_code
      - fall_2021_tsds_peims_foster_careindicator
      - blank_48
      - fall_2021_tsds_peims_dyslexia_indicator_code
      - blank_50
      - new_to_texas
      - tx_unique_student_id
      - local_use_reading
      - local_use_mathematics
      - blank_56
      - local_use_social_studies
      - local_use_science
      - agency_use_a_reading
      - agency_use_b_reading
      - agency_use_c_reading
      - agency_use_d_reading
      - agency_use_e_reading
      - agency_use_a_mathematics
      - agency_use_b_mathematics
      - agency_use_c_mathematics
      - agency_use_d_mathematics
      - agency_use_e_mathematics
      - blank_70
      - agency_use_a_social_studies
      - agency_use_b_social_studies
      - agency_use_c_social_studies
      - agency_use_d_social_studies
      - agency_use_e_social_studies
      - agency_use_a_science
      - agency_use_b_science
      - agency_use_c_science
      - agency_use_d_science
      - agency_use_e_science
      - blank_81
      - score_code_reading
      - score_code_mathematics
      - blank_85
      - score_code_social_studies
      - score_code_science
      - blank_89
      - reading_reporting_category_1scores
      - reading_reporting_category_2scores
      - reading_reporting_category_3scores
      - reading_raw_score
      - reading_scale_score
      - blank_96
      - reading_test_version
      - blank_98
      - reading_translated_studentmaterials
      - blank_100
      - level_ii__satisfactory_academic_performance_in_reading
      - level_iii__accomplished_academic_performance_in_reading
      - staar_alternate_2_readingprogress_measure
      - blank_105
      - on_track_to_level_ii__satisfactoryacademic_performance_reading
      - previous_year_administration_date__reading
      - previous_year_scale_score__reading
      - blank_109
      - previous_year_score_code__reading
      - previous_year_level_ii__satisfactoryacademic_performance_reading
      - previous_year_level_iii_accomplished_academic_performance_reading
      - previous_year_tested_grade__reading
      - blank_115
      - color_or_highlight_117
      - color_overlays_118
      - blank_119
      - photographs_or_objects_120
      - textured_materials_121
      - demonstrate_122
      - raise_or_darken_outline_123
      - enlarge_124
      - braille_125
      - describe_images_126
      - provide_images_or_text_separately_127
      - isolate_images_128
      - picture_representations_129
      - reread_text_130
      - use_calculator,_manipulatives,_ormath_tools_131
      - provide_structured_reminders_132
      - blank_133
      - mathematics_reporting_categoryscores_1
      - mathematics_reading_reportingcategory_2_scores
      - mathematics_reading_reportingcategory_3_scores
      - mathematics_reading_reportingcategory_4_scores
      - blank_139
      - mathematics_raw_score
      - mathematics_scale_score
      - blank_142
      - mathematics_test_version
      - blank_144
      - mathematics_translated_studentmaterials
      - blank_147
      - level_ii__satisfactory_academic_performance_in_mathematics
      - level_iii__accomplished_academic_performance_in_mathematics
      - staar_alternate_2_mathematicsprogress_measure
      - blank_152
      - on_track_to_level_ii__satisfactoryacademic_performance_153
      - previous_year_administration_date__mathematics
      - previous_year_scale_score__mathematics
      - blank_156
      - previous_year_score_code__mathematics
      - previous_year_level_ii__satisfactoryacademic_performance__mathematics
      - previous_year_iii__accomplishedacademic_performance__mathematics
      - previous_year_tested_grade__mathematics
      - blank_161
      - color_or_highlight_163
      - color_overlays_164
      - blank_165
      - photographs_or_objects_166
      - textured_materials_167
      - demonstrate_168
      - raise_or_darken_outline_169
      - enlarge_170
      - braille_171
      - describe_images_172
      - provide_images_or_text_separately_174
      - isolate_images_175
      - picture_representations_176
      - reread_text_177
      - use_calculator,_manipulatives,_ormath_tools_178
      - provide_structured_reminders_179
      - blank_180
      - social_studies_reporting_categoryscores_1
      - social_studies_reporting_categoryscores_2
      - social_studies_reporting_categoryscores_3
      - social_studies_reporting_categoryscores_4
      - social_studies_raw_score
      - social_studies_scale_score
      - blank_188
      - social_studies_test_version
      - blank_190
      - social_studies_translated_studentmaterials
      - blank_192
      - level_ii__satisfactory_academic_performance_in_social_studies
      - level_iii__accomplished_academic_performance_in_social_studies
      - blank_195
      - color_or_highlight_197
      - color_overlays_198
      - blank_199
      - photographs_or_objects_200
      - textured_materials_201
      - demonstrate_202
      - raise_or_darken_outline_203
      - enlarge_205
      - braille_206
      - describe_images_207
      - provide_images_or_text_separately_208
      - isolate_images_209
      - picture_representations_210
      - reread_text_211
      - use_calculator,_manipulatives,_ormath_tools_212
      - provide_structured_reminders_213
      - blank_214
      - science_reporting_category_1scores
      - science_reporting_category_2scores
      - science_reporting_category_3scores
      - science_reporting_category_4scores
      - science_raw_score
      - science_scale_score
      - blank_222
      - science_test_version
      - blank_224
      - science_translated_studentmaterials
      - blank_226
      - level_ii__satisfactory_academic_performance_in_science
      - level_iii__accomplished_academic_performance_in_science
      - blank_229
      - color_or_highlight_231
      - color_overlays_232
      - blank_233
      - photographs_or_objects_234
      - textured_materials_236
      - demonstrate_237
      - raise_or_darken_outline_238
      - enlarge_239
      - braille_240
      - describe_images_241
      - provide_images_or_text_separately_242
      - isolate_images_243
      - picture_representations_244
      - reread_text_245
      - use_calculator,_manipulatives,_ormath_tools_246
      - provide_structured_reminders_247
      - blank_248
      - county_district_campus_number_250
      - blank_251
      - score_code_252
      - level_ii__satisfactory_academic_performance_253
      - level_iii__accomplished_academic_performance_254
      - scale_score_255
      - tested_grade_256
      - blank_257
      - on_track_to_level_ii__satisfactoryacademic_performance_258
      - staar_alternate_2_progressmeasure_259
      - blank_260
      - county_district_campus_number_262
      - blank_263
      - score_code_264
      - level_ii__satisfactory_academic_performance_265
      - level_iii__accomplished_academic_performance_266
      - scale_score_268
      - tested_grade_269
      - blank_270
      - on_track_to_level_ii__satisfactoryacademic_performance_271
      - staar_alternate_2_progressmeasure_272
      - blank_273
      - county_district_campus_number_275
      - blank_276
      - score_code_277
      - level_ii__satisfactory_academic_performance_278
      - level_iii__accomplished_academic_performance_279
      - scale_score_280
      - tested_grade_281
      - blank_282
      - county_district_campus_number_284
      - blank_285
      - score_code_286
      - level_ii__satisfactory_academic_performance_287
      - level_iii__accomplished_academic_performance_288
      - scale_score_289
      - tested_grade_290
      - blank_291
      - county_district_campus_number_293
      - blank_294
      - score_code_295
      - level_ii__satisfactory_academic_performance_296
      - level_iii__accomplished_academic_performance_298
      - scale_score_299
      - tested_grade_300
      - blank_301
      - fall_2021_tsds_peims_crisis_code_1
      - fall_2021_tsds_peims_crisis_code_2
      - fall_2021_tsds_peims_crisis_code_3
      - test_result_id_reading
      - test_result_id_mathematics
      - test_result_id_social_studies
      - test_result_id_science
      - blank_311
      - opportunity_key_reading
      - opportunity_key_mathematics
      - opportunity_key_social_studies
      - opportunity_key_science
      - blank_316
      - non_participant_online_refusal__reading
      - non_participant_online_refusal__mathematics
      - non_participant_online_refusal__social_studies
      - non_participant_online_refusal__science
      - blank_321
      - period
    colspecs:
      - [0, 4]
      - [4, 6]
      - [6, 8]
      - [8, 17]
      - [17, 32]
      - [32, 47]
      - [47, 62]
      - [62, 72]
      - [72, 73]
      - [73, 82]
      - [82, 83]
      - [83, 91]
      - [91, 92]
      - [92, 93]
      - [93, 94]
      - [94, 95]
      - [95, 96]
      - [96, 97]
      - [97, 98]
      - [98, 99]
      - [99, 100]
      - [100, 101]
      - [101, 102]
      - [102, 106]
      - [106, 107]
      - [107, 108]
      - [108, 109]
      - [109, 110]
      - [110, 111]
      - [111, 116]
      - [116, 117]
      - [117, 118]
      - [118, 122]
      - [122, 131]
      - [131, 143]
      - [143, 152]
      - [152, 154]
      - [154, 156]
      - [156, 162]
      - [162, 163]
      - [163, 164]
      - [164, 165]
      - [165, 185]
      - [185, 186]
      - [186, 189]
      - [189, 190]
      - [190, 200]
      - [200, 204]
      - [204, 208]
      - [208, 212]
      - [212, 216]
      - [216, 220]
      - [220, 221]
      - [221, 222]
      - [222, 223]
      - [223, 224]
      - [224, 225]
      - [225, 226]
      - [226, 227]
      - [227, 228]
      - [228, 229]
      - [229, 230]
      - [230, 235]
      - [235, 236]
      - [236, 237]
      - [237, 238]
      - [238, 239]
      - [239, 240]
      - [240, 241]
      - [241, 242]
      - [242, 243]
      - [243, 244]
      - [244, 245]
      - [245, 350]
      - [350, 351]
      - [351, 352]
      - [352, 353]
      - [353, 354]
      - [354, 355]
      - [355, 400]
      - [400, 402]
      - [402, 404]
      - [404, 406]
      - [406, 408]
      - [408, 412]
      - [412, 413]
      - [413, 414]
      - [414, 415]
      - [415, 416]
      - [416, 423]
      - [423, 424]
      - [424, 425]
      - [425, 426]
      - [426, 428]
      - [428, 429]
      - [429, 433]
      - [433, 437]
      - [437, 439]
      - [439, 440]
      - [440, 441]
      - [441, 442]
      - [442, 444]
      - [444, 650]
      - [650, 651]
      - [651, 652]
      - [652, 653]
      - [653, 654]
      - [654, 655]
      - [655, 656]
      - [656, 657]
      - [657, 658]
      - [658, 659]
      - [659, 660]
      - [660, 661]
      - [661, 662]
      - [662, 663]
      - [663, 664]
      - [664, 665]
      - [665, 666]
      - [666, 750]
      - [750, 752]
      - [752, 754]
      - [754, 756]
      - [756, 758]
      - [758, 760]
      - [760, 762]
      - [762, 766]
      - [766, 767]
      - [767, 768]
      - [768, 769]
      - [769, 770]
      - [770, 777]
      - [777, 778]
      - [778, 779]
      - [779, 780]
      - [780, 781]
      - [781, 782]
      - [782, 786]
      - [786, 790]
      - [790, 792]
      - [792, 793]
      - [793, 794]
      - [794, 795]
      - [795, 797]
      - [797, 1000]
      - [1000, 1001]
      - [1001, 1002]
      - [1002, 1003]
      - [1003, 1004]
      - [1004, 1005]
      - [1005, 1006]
      - [1006, 1007]
      - [1007, 1008]
      - [1008, 1009]
      - [1009, 1010]
      - [1010, 1011]
      - [1011, 1012]
      - [1012, 1013]
      - [1013, 1014]
      - [1014, 1015]
      - [1015, 1016]
      - [1016, 1500]
      - [1500, 1502]
      - [1502, 1504]
      - [1504, 1506]
      - [1506, 1508]
      - [1508, 1510]
      - [1510, 1514]
      - [1514, 1515]
      - [1515, 1516]
      - [1516, 1517]
      - [1517, 1518]
      - [1518, 1525]
      - [1525, 1526]
      - [1526, 1527]
      - [1527, 1800]
      - [1800, 1801]
      - [1801, 1802]
      - [1802, 1803]
      - [1803, 1804]
      - [1804, 1805]
      - [1805, 1806]
      - [1806, 1807]
      - [1807, 1808]
      - [1808, 1809]
      - [1809, 1810]
      - [1810, 1811]
      - [1811, 1812]
      - [1812, 1813]
      - [1813, 1814]
      - [1814, 1815]
      - [1815, 1816]
      - [1816, 1900]
      - [1900, 1902]
      - [1902, 1904]
      - [1904, 1906]
      - [1906, 1908]
      - [1908, 1910]
      - [1910, 1914]
      - [1914, 1915]
      - [1915, 1916]
      - [1916, 1917]
      - [1917, 1918]
      - [1918, 1925]
      - [1925, 1926]
      - [1926, 1927]
      - [1927, 2200]
      - [2200, 2201]
      - [2201, 2202]
      - [2202, 2203]
      - [2203, 2204]
      - [2204, 2205]
      - [2205, 2206]
      - [2206, 2207]
      - [2207, 2208]
      - [2208, 2209]
      - [2209, 2210]
      - [2210, 2211]
      - [2211, 2212]
      - [2212, 2213]
      - [2213, 2214]
      - [2214, 2215]
      - [2215, 2216]
      - [2216, 2530]
      - [2530, 2539]
      - [2539, 2541]
      - [2541, 2542]
      - [2542, 2543]
      - [2543, 2544]
      - [2544, 2548]
      - [2548, 2550]
      - [2550, 2552]
      - [2552, 2553]
      - [2553, 2554]
      - [2554, 2650]
      - [2650, 2659]
      - [2659, 2661]
      - [2661, 2662]
      - [2662, 2663]
      - [2663, 2664]
      - [2664, 2668]
      - [2668, 2670]
      - [2670, 2672]
      - [2672, 2673]
      - [2673, 2674]
      - [2674, 2740]
      - [2740, 2749]
      - [2749, 2751]
      - [2751, 2752]
      - [2752, 2753]
      - [2753, 2754]
      - [2754, 2758]
      - [2758, 2760]
      - [2760, 2770]
      - [2770, 2779]
      - [2779, 2781]
      - [2781, 2782]
      - [2782, 2783]
      - [2783, 2784]
      - [2784, 2788]
      - [2788, 2790]
      - [2790, 2800]
      - [2800, 2809]
      - [2809, 2811]
      - [2811, 2812]
      - [2812, 2813]
      - [2813, 2814]
      - [2814, 2818]
      - [2818, 2820]
      - [2820, 3135]
      - [3135, 3138]
      - [3138, 3141]
      - [3141, 3144]
      - [3144, 3153]
      - [3153, 3162]
      - [3162, 3171]
      - [3171, 3180]
      - [3180, 3186]
      - [3186, 3222]
      - [3222, 3258]
      - [3258, 3294]
      - [3294, 3330]
      - [3330, 3366]
      - [3366, 3367]
      - [3367, 3368]
      - [3368, 3369]
      - [3369, 3370]
      - [3370, 3999]
      - [3999, 4000]
    {% elif ${API_YEAR} == "2021" %}
    columns:
      - administration_date
      - grade_level_code
      - esc_region_number
      - county_district_campus_number
      - district_name
      - campus_name
      - last_name
      - first_name
      - middle_initial
      - student_id
      - sex_code
      - date_of_birth
      - blank_14
      - hispanic_latino_code
      - american_indian_alaska_native_code
      - asian_code
      - black_african_american_code
      - native_hawaiian_pacific_islander_code
      - white_code
      - ethnicity/race_reporting_category
      - economic_disadvantage_code
      - title_i_part_a_indicator_code
      - migrant_indicator_code
      - blank_27
      - emergent_bilingual_indicator_code
      - bilingual_indicator_code
      - esl_indicator_code
      - blank_31
      - special_ed_indicator_code
      - blank_33
      - gifted_talented_indicator_code
      - at_risk_indicator_code
      - blank_36
      - local_student_id
      - blank_39
      - fall_2020_tsds_peims_county_district_campus_number
      - fall_2020_tsds_peims_crisis_code
      - fall_2020_tsds_peims_studentattribution_code
      - student_portal_unique_accesscode
      - migrant_student_in_texas_migrantinterstate_program_(tmip)
      - fall_2020_tsds_peims_dyslexia_indicator_code
      - fall_2020_tsds_peims_military_connected_student_code
      - fall_2020_tsds_peims_foster_careindicator
      - class_group_name
      - blank_50
      - new_to_texas
      - tx_unique_student_id
      - local_use_reading
      - local_use_mathematics
      - local_use_writing
      - local_use_social_studies
      - local_use_science
      - agency_use_reading
      - agency_use_mathematics
      - agency_use_writing
      - agency_use_social_studies
      - agency_use_science
      - blank_81
      - score_code_reading
      - score_code_mathematics
      - score_code_writing
      - score_code_social_studies
      - score_code_science
      - blank_89
      - reading_reporting_category_scores
      - reading_raw_score
      - reading_scale_score
      - blank_96
      - reading_test_version
      - blank_98
      - reading_translated_studentmaterials
      - blank_100
      - level_ii__satisfactory_academic_performance_in_reading
      - level_iii__accomplished_academic_performance_in_reading
      - staar_alternate_2_readingprogress_measure
      - blank_105
      - on_track_to_level_ii__satisfactoryacademic_performance_reading
      - previous_year_administration_date__reading
      - previous_year_scale_score__reading
      - blank_109
      - previous_year_score_code__reading
      - previous_year_level_ii__satisfactoryacademic_performance_reading
      - previous_year_level_iii_accomplished_academic_performance_reading
      - previous_year_tested_grade__reading
      - blank_115
      - color_or_highlight_117
      - color_overlays_118
      - blank_119
      - photographs_or_objects_120
      - textured_materials_121
      - demonstrate_122
      - raise_or_darken_outline_123
      - enlarge_124
      - braille_125
      - describe_images_126
      - provide_images_or_text_separately_127
      - isolate_images_128
      - picture_representations_129
      - reread_text_130
      - use_calculator,_manipulatives,_ormath_tools_131
      - provide_structured_reminders_132
      - blank_133
      - mathematics_reporting_category_scores
      - blank_139
      - mathematics_raw_score
      - mathematics_scale_score
      - blank_142
      - mathematics_test_version
      - blank_144
      - mathematics_translated_studentmaterials
      - blank_147
      - level_ii__satisfactory_academic_performance_in_mathematics
      - level_iii__accomplished_academic_performance_in_mathematics
      - staar_alternate_2_mathematicsprogress_measure
      - blank_152
      - on_track_to_level_ii__satisfactoryacademic_performance_153
      - previous_year_administration_date__mathematics
      - previous_year_scale_score__mathematics
      - blank_156
      - previous_year_score_code__mathematics
      - previous_year_level_ii__satisfactoryacademic_performance__mathematics
      - previous_year_iii__accomplishedacademic_performance__mathematics
      - previous_year_tested_grade__mathematics
      - blank_160
      - color_or_highlight_163
      - color_overlays_164
      - blank_161
      - photographs_or_objects_166
      - textured_materials_167
      - demonstrate_168
      - raise_or_darken_outline_169
      - enlarge_170
      - braille_171
      - describe_images_172
      - provide_images_or_text_separately_174
      - isolate_images_175
      - picture_representations_176
      - reread_text_177
      - use_calculator,_manipulatives,_ormath_tools_178
      - provide_structured_reminders_179
      - blank_162
      - writing_reporting_category_scores
      - writing_raw_score
      - writing_scale_score
      - blank_163
      - writing_test_version
      - blank_164
      - writing_translated_student_materials
      - blank_165
      - level_ii__satisfactory_academic_performance_in_writing
      - level_iii__accomplished_academic_performance_in_writing
      - blank_166
      - color_or_highlight_writing
      - color_overlays_writing
      - blank_167
      - photographs_or_objects_writing
      - textured_materials_writing
      - demonstrate_writing
      - raise_or_darken_outline_writing
      - enlarge_writing
      - braille_writing
      - describe_images_writing
      - provide_images_or_text_separately_writing
      - isolate_images_writing
      - picture_representations_writing
      - reread_text_writing
      - use_calculator,_manipulatives,_ormath_tools_writing
      - provide_structured_reminders_writing
      - blank_180
      - social_studies_reporting_category_scores
      - social_studies_raw_score
      - social_studies_scale_score
      - blank_188
      - social_studies_test_version
      - blank_190
      - social_studies_translated_studentmaterials
      - blank_192
      - level_ii__satisfactory_academic_performance_in_social_studies
      - level_iii__accomplished_academic_performance_in_social_studies
      - blank_195
      - color_or_highlight_197
      - color_overlays_198
      - blank_199
      - photographs_or_objects_200
      - textured_materials_201
      - demonstrate_202
      - raise_or_darken_outline_203
      - enlarge_205
      - braille_206
      - describe_images_207
      - provide_images_or_text_separately_208
      - isolate_images_209
      - picture_representations_210
      - reread_text_211
      - use_calculator,_manipulatives,_ormath_tools_212
      - provide_structured_reminders_213
      - blank_214
      - science_reporting_category_scores
      - science_raw_score
      - science_scale_score
      - blank_222
      - science_test_version
      - blank_224
      - science_translated_studentmaterials
      - blank_226
      - level_ii__satisfactory_academic_performance_in_science
      - level_iii__accomplished_academic_performance_in_science
      - blank_229
      - color_or_highlight_231
      - color_overlays_232
      - blank_233
      - photographs_or_objects_234
      - textured_materials_236
      - demonstrate_237
      - raise_or_darken_outline_238
      - enlarge_239
      - braille_240
      - describe_images_241
      - provide_images_or_text_separately_242
      - isolate_images_243
      - picture_representations_244
      - reread_text_245
      - use_calculator,_manipulatives,_ormath_tools_246
      - provide_structured_reminders_247
      - blank_248
      - county_district_campus_number_250
      - blank_251
      - score_code_252
      - level_ii__satisfactory_academic_performance_253
      - level_iii__accomplished_academic_performance_254
      - scale_score_255
      - tested_grade_256
      - blank_257
      - on_track_to_level_ii__satisfactoryacademic_performance_258
      - staar_alternate_2_progressmeasure_259
      - blank_260
      - county_district_campus_number_262
      - blank_263
      - score_code_264
      - level_ii__satisfactory_academic_performance_265
      - level_iii__accomplished_academic_performance_266
      - scale_score_268
      - tested_grade_269
      - blank_270
      - on_track_to_level_ii__satisfactoryacademic_performance_271
      - staar_alternate_2_progressmeasure_272
      - blank_273
      - county_district_campus_number_275
      - blank_276
      - score_code_277
      - level_ii__satisfactory_academic_performance_278
      - level_iii__accomplished_academic_performance_279
      - scale_score_280
      - tested_grade_281
      - blank_282
      - county_district_campus_number_284
      - blank_285
      - score_code_286
      - level_ii__satisfactory_academic_performance_287
      - level_iii__accomplished_academic_performance_288
      - scale_score_289
      - tested_grade_290
      - blank_291
      - county_district_campus_number_293
      - blank_294
      - score_code_295
      - level_ii__satisfactory_academic_performance_296
      - level_iii__accomplished_academic_performance_298
      - scale_score_299
      - tested_grade_300
      - blank_301
      - period
    colspecs:
      - [0, 4]
      - [4, 6]
      - [6, 8]
      - [8, 17]
      - [17, 32]
      - [32, 47]
      - [47, 62]
      - [62, 72]
      - [72, 73]
      - [73, 82]
      - [82, 83]
      - [83, 91]
      - [91, 92]
      - [92, 93]
      - [93, 94]
      - [94, 95]
      - [95, 96]
      - [96, 97]
      - [97, 98]
      - [98, 99]
      - [99, 100]
      - [100, 101]
      - [101, 102]
      - [102, 106]
      - [106, 107]
      - [107, 108]
      - [108, 109]
      - [109, 110]
      - [110, 111]
      - [111, 116]
      - [116, 117]
      - [117, 118]
      - [118, 122]
      - [122, 131]
      - [131, 143]
      - [143, 152]
      - [152, 154]
      - [154, 156]
      - [156, 162]
      - [162, 163]
      - [163, 164]
      - [164, 165]
      - [165, 166]
      - [166, 186]
      - [186, 189]
      - [189, 190]
      - [190, 200]
      - [200, 204]
      - [204, 208]
      - [208, 212]
      - [212, 216]
      - [216, 220]
      - [220, 225]
      - [225, 230]
      - [230, 235]
      - [235, 240]
      - [240, 245]
      - [245, 350]
      - [350, 351]
      - [351, 352]
      - [352, 353]
      - [353, 354]
      - [354, 355]
      - [355, 400]
      - [400, 406]
      - [406, 408]
      - [408, 412]
      - [412, 413]
      - [413, 414]
      - [414, 415]
      - [415, 416]
      - [416, 423]
      - [423, 424]
      - [424, 425]
      - [425, 426]
      - [426, 428]
      - [428, 429]
      - [429, 433]
      - [433, 437]
      - [437, 439]
      - [439, 440]
      - [440, 441]
      - [441, 442]
      - [442, 444]
      - [444, 650]
      - [650, 651]
      - [651, 652]
      - [652, 653]
      - [653, 654]
      - [654, 655]
      - [655, 656]
      - [656, 657]
      - [657, 658]
      - [658, 659]
      - [659, 660]
      - [660, 661]
      - [661, 662]
      - [662, 663]
      - [663, 664]
      - [664, 665]
      - [665, 666]
      - [666, 750]
      - [750, 758]
      - [758, 760]
      - [760, 762]
      - [762, 766]
      - [766, 767]
      - [767, 768]
      - [768, 769]
      - [769, 770]
      - [770, 777]
      - [777, 778]
      - [778, 779]
      - [779, 780]
      - [780, 781]
      - [781, 782]
      - [782, 786]
      - [786, 790]
      - [790, 792]
      - [792, 793]
      - [793, 794]
      - [794, 795]
      - [795, 797]
      - [797, 1000]
      - [1000, 1001]
      - [1001, 1002]
      - [1002, 1003]
      - [1003, 1004]
      - [1004, 1005]
      - [1005, 1006]
      - [1006, 1007]
      - [1007, 1008]
      - [1008, 1009]
      - [1009, 1010]
      - [1010, 1011]
      - [1011, 1012]
      - [1012, 1013]
      - [1013, 1014]
      - [1014, 1015]
      - [1015, 1016]
      - [1016, 1100]
      - [1100, 1106]
      - [1106, 1108]
      - [1108, 1112]
      - [1112, 1113]
      - [1113, 1114]
      - [1114, 1115]
      - [1115, 1116]
      - [1116, 1123]
      - [1123, 1124]
      - [1124, 1125]
      - [1125, 1400]
      - [1400, 1401]
      - [1401, 1402]
      - [1402, 1403]
      - [1403, 1404]
      - [1404, 1405]
      - [1405, 1406]
      - [1406, 1407]
      - [1407, 1408]
      - [1408, 1409]
      - [1409, 1410]
      - [1410, 1411]
      - [1411, 1412]
      - [1412, 1413]
      - [1413, 1414]
      - [1414, 1415]
      - [1415, 1416]
      - [1416, 1500]
      - [1500, 1508]
      - [1508, 1510]
      - [1510, 1514]
      - [1514, 1515]
      - [1515, 1516]
      - [1516, 1517]
      - [1517, 1518]
      - [1518, 1525]
      - [1525, 1526]
      - [1526, 1527]
      - [1527, 1800]
      - [1800, 1801]
      - [1801, 1802]
      - [1802, 1803]
      - [1803, 1804]
      - [1804, 1805]
      - [1805, 1806]
      - [1806, 1807]
      - [1807, 1808]
      - [1808, 1809]
      - [1809, 1810]
      - [1810, 1811]
      - [1811, 1812]
      - [1812, 1813]
      - [1813, 1814]
      - [1814, 1815]
      - [1815, 1816]
      - [1816, 1900]
      - [1900, 1908]
      - [1908, 1910]
      - [1910, 1914]
      - [1914, 1915]
      - [1915, 1916]
      - [1916, 1917]
      - [1917, 1918]
      - [1918, 1925]
      - [1925, 1926]
      - [1926, 1927]
      - [1927, 2200]
      - [2200, 2201]
      - [2201, 2202]
      - [2202, 2203]
      - [2203, 2204]
      - [2204, 2205]
      - [2205, 2206]
      - [2206, 2207]
      - [2207, 2208]
      - [2208, 2209]
      - [2209, 2210]
      - [2210, 2211]
      - [2211, 2212]
      - [2212, 2213]
      - [2213, 2214]
      - [2214, 2215]
      - [2215, 2216]
      - [2216, 2530]
      - [2530, 2539]
      - [2539, 2541]
      - [2541, 2542]
      - [2542, 2543]
      - [2543, 2544]
      - [2544, 2548]
      - [2548, 2550]
      - [2550, 2552]
      - [2552, 2553]
      - [2553, 2554]
      - [2554, 2650]
      - [2650, 2659]
      - [2659, 2661]
      - [2661, 2662]
      - [2662, 2663]
      - [2663, 2664]
      - [2664, 2668]
      - [2668, 2670]
      - [2670, 2672]
      - [2672, 2673]
      - [2673, 2674]
      - [2674, 2740]
      - [2740, 2749]
      - [2749, 2751]
      - [2751, 2752]
      - [2752, 2753]
      - [2753, 2754]
      - [2754, 2758]
      - [2758, 2760]
      - [2760, 2770]
      - [2770, 2779]
      - [2779, 2781]
      - [2781, 2782]
      - [2782, 2783]
      - [2783, 2784]
      - [2784, 2788]
      - [2788, 2790]
      - [2790, 2800]
      - [2800, 2809]
      - [2809, 2811]
      - [2811, 2812]
      - [2812, 2813]
      - [2813, 2814]
      - [2814, 2818]
      - [2818, 2820]
      - [2820, 3999]
      - [3999, 4000]
    {% endif %}

  # OTHER XWALKS
  administration_window_xwalk:
    file: ../../seeds/administration_window_xwalk.csv
    header_rows: 1

{% set conformed_columns = 
  ['${STUDENT_ID_NAME}',
   'assessment_identifier',
   'grade_level_code',
   'administration_window',
   'administration_window_label',
   'administration_window_start_date',
   'administration_window_end_date',
   'county_district_campus_number',
   'subject',
   'reporting_category_1_raw_score',
   'reporting_category_2_raw_score',
   'reporting_category_3_raw_score',
   'reporting_category_4_raw_score',
   'reporting_category_1_name',
   'reporting_category_2_name',
   'reporting_category_3_name',
   'reporting_category_4_name',
   'raw_score',
   'scale_score',
   'test_version',
   'score_code',
   'overall_performance_level',
   'stu_assess_id'
  ] 
%}

transformations:
  input:
    source: $sources.input
    operations: []

  # CONFORMED 3-8 ALT
  conformed_staar_summative_alt:
    source: $transformations.input
    operations:
      # RENAME columns to easily convert from wide to long
      - operation: rename_columns
        columns:
          "administration_date": administration_window
          {% if ${API_YEAR} >= 2023 %}
          # standardize score names so we can easily convert from wide to long
          "reading_language_arts_reportingcategory_1_scores": reading_reporting_category_1_raw_score
          "reading_language_arts_reportingcategory_2_scores": reading_reporting_category_2_raw_score
          "reading_language_arts_raw_score": reading_raw_score
          "reading_language_arts_scale_score": reading_scale_score
          "reading_language_arts_test_version": reading_test_version
          "level_ii__satisfactory_academic_performance_in_reading_languagearts": level_ii__satisfactory_academic_performance_in_reading
          "level_iii__accomplished_academic_performance_in_reading_languagearts": level_iii__accomplished_academic_performance_in_reading
          "score_code_reading_language_arts": score_code_reading
          "opportunity_key_readinglanguage_arts": opportunity_key_reading
          "mathematics_reporting_category_1scores": mathematics_reporting_category_1_raw_score
          "mathematics_reporting_category_2scores": mathematics_reporting_category_2_raw_score
          "mathematics_reporting_category_3scores": mathematics_reporting_category_3_raw_score
          "mathematics_reporting_category_4scores": mathematics_reporting_category_4_raw_score
          "social_studies_reporting_category_1scores": social_studies_reporting_category_1_raw_score
          "social_studies_reporting_category_2scores": social_studies_reporting_category_2_raw_score
          "social_studies_reporting_category_3scores": social_studies_reporting_category_3_raw_score
          "social_studies_reporting_category_4scores": social_studies_reporting_category_4_raw_score
          "science_reporting_category_1scores": science_reporting_category_1_raw_score
          "science_reporting_category_2scores": science_reporting_category_2_raw_score
          "science_reporting_category_3scores": science_reporting_category_3_raw_score
          "science_reporting_category_4scores": science_reporting_category_4_raw_score
          # This column doesn't exist after 2022 -- TODO better way to handle this case?
          {% elif ${API_YEAR} == 2022 %}
          # standardize score names so we can easily convert from wide to long
          "reading_reporting_category_1scores": reading_reporting_category_1_raw_score
          "reading_reporting_category_2scores": reading_reporting_category_2_raw_score
          "reading_reporting_category_3scores": reading_reporting_category_3_raw_score
          "mathematics_reporting_categoryscores_1": mathematics_reporting_category_1_raw_score
          "mathematics_reading_reportingcategory_2_scores": mathematics_reporting_category_2_raw_score
          "mathematics_reading_reportingcategory_3_scores": mathematics_reporting_category_3_raw_score
          "mathematics_reading_reportingcategory_4_scores": mathematics_reporting_category_4_raw_score
          "social_studies_reporting_categoryscores_1": social_studies_reporting_category_1_raw_score
          "social_studies_reporting_categoryscores_2": social_studies_reporting_category_2_raw_score
          "social_studies_reporting_categoryscores_3": social_studies_reporting_category_3_raw_score
          "social_studies_reporting_categoryscores_4": social_studies_reporting_category_4_raw_score
          "science_reporting_category_1scores": science_reporting_category_1_raw_score
          "science_reporting_category_2scores": science_reporting_category_2_raw_score
          "science_reporting_category_3scores": science_reporting_category_3_raw_score
          "science_reporting_category_4scores": science_reporting_category_4_raw_score
          {% endif %}
      # ADD assess_id and missing cols
      - operation: add_columns
        columns:
          assessment_identifier: staar_summative_alt
          school_year: "${API_YEAR}"
          # TODO confirm whether this placeholder is necessary
          course_abbrev: "no_course"
          # reading does not have a score 4. create one, so we can easily convert from wide to long
          reading_reporting_category_4_raw_score: ""
            # This column doesn't exist after 2022 -- TODO better way to handle this case?
          {% if ${API_YEAR} >= 2023 %}
          reading_reporting_category_3_raw_score: ""
          {% endif %}
          # in 2021 and earlier, reporting category scores were store in one column, e.g. '423' represented ['4','2','3']
          {% if ${API_YEAR} <= 2021 %}
          reading_reporting_category_1_raw_score: "{%raw%}{{reading_reporting_category_scores[0:2]}}{%endraw%}"
          reading_reporting_category_2_raw_score: "{%raw%}{{reading_reporting_category_scores[2:4]}}{%endraw%}"
          reading_reporting_category_3_raw_score: "{%raw%}{{reading_reporting_category_scores[4:6]}}{%endraw%}"
          mathematics_reporting_category_1_raw_score: "{%raw%}{{mathematics_reporting_category_scores[0:2]}}{%endraw%}"
          mathematics_reporting_category_2_raw_score: "{%raw%}{{mathematics_reporting_category_scores[2:4]}}{%endraw%}"
          mathematics_reporting_category_3_raw_score: "{%raw%}{{mathematics_reporting_category_scores[4:6]}}{%endraw%}"
          mathematics_reporting_category_4_raw_score: "{%raw%}{{mathematics_reporting_category_scores[6:8]}}{%endraw%}"
          social_studies_reporting_category_1_raw_score: "{%raw%}{{social_studies_reporting_category_scores[0:2]}}{%endraw%}"
          social_studies_reporting_category_2_raw_score: "{%raw%}{{social_studies_reporting_category_scores[2:4]}}{%endraw%}"
          social_studies_reporting_category_3_raw_score: "{%raw%}{{social_studies_reporting_category_scores[4:6]}}{%endraw%}"
          social_studies_reporting_category_4_raw_score: "{%raw%}{{social_studies_reporting_category_scores[6:8]}}{%endraw%}"
          science_reporting_category_1_raw_score: "{%raw%}{{science_reporting_category_scores[0:2]}}{%endraw%}"
          science_reporting_category_2_raw_score: "{%raw%}{{science_reporting_category_scores[2:4]}}{%endraw%}"
          science_reporting_category_3_raw_score: "{%raw%}{{science_reporting_category_scores[4:6]}}{%endraw%}"
          science_reporting_category_4_raw_score: "{%raw%}{{science_reporting_category_scores[6:8]}}{%endraw%}"
          writing_reporting_category_1_raw_score: "{%raw%}{{writing_reporting_category_scores[0:2]}}{%endraw%}"
          writing_reporting_category_2_raw_score: "{%raw%}{{writing_reporting_category_scores[2:4]}}{%endraw%}"
          writing_reporting_category_3_raw_score: "{%raw%}{{writing_reporting_category_scores[4:6]}}{%endraw%}"
          writing_reporting_category_4_raw_score: ""
          {% endif %}


  # 3-8 ALT -- CONVERT FROM WIDE TO LONG
  {% set subjects = {
    'reading': 'Reading',
    'mathematics': 'Mathematics',
    'social_studies': 'Social Studies',
    'science': 'Science'
    }
  %}
  {% if ${API_YEAR} <= 2021 %}
    {% set _ = subjects.update({'writing': 'Writing'}) %}
  {% endif %}
  {% for subject in subjects %}
  {% set descriptor_subject = subjects[subject] %}
  staar_summative_alt_scores_{{subject}}:
    source: $transformations.conformed_staar_summative_alt
    operations:
      # RENAME subject-specific columns to generic colnames so we can stack the data long
      - operation: rename_columns
        columns:
          {{subject}}_reporting_category_1_raw_score: reporting_category_1_raw_score
          {{subject}}_reporting_category_2_raw_score: reporting_category_2_raw_score
          {{subject}}_reporting_category_3_raw_score: reporting_category_3_raw_score
          {{subject}}_reporting_category_4_raw_score: reporting_category_4_raw_score
          {{subject}}_raw_score: raw_score
          {{subject}}_scale_score: scale_score
          {{subject}}_test_version: test_version
          level_ii__satisfactory_academic_performance_in_{{subject}}: level_2_satisfactory_academic_performance
          level_iii__accomplished_academic_performance_in_{{subject}}: level_3_accomplished_academic_performance
          score_code_{{subject}}: score_code
          {% if ${API_YEAR} >= 2022 %}
          opportunity_key_{{subject}}: stu_assess_id
          {% endif %}
      # ADD subject, missing cols, overall_pl
      - operation: add_columns
        columns:
          subject: {{descriptor_subject}}
          # in 2021 and earlier, opportunity key didn't exist, so create own unique key
          {% if ${API_YEAR} <= 2021 %}
          stu_assess_id: "{%raw%}{{tx_unique_student_id}}_{{subject}}{%endraw%}"
          {% endif %}
          # use component PL columns to create overall PL
          overall_performance_level: >
            {%raw%}
              {%- if level_3_accomplished_academic_performance == "1" -%}
                Accomplished
              {%- elif level_2_satisfactory_academic_performance == "1" -%}
                Satisfactory
              {%- else -%}
                Developing
              {%- endif -%}
            {%endraw%}
      # DEDUPE years 2021 and prior, before opportunity_key was available
      {% if ${API_YEAR} <= 2021 %}
      - operation: group_by_with_rank
        group_by_columns:
          - stu_assess_id
        rank_column: stu_assess_row_number
      - operation: modify_columns
        columns:
          stu_assess_id: "{%raw%}{{value}}_{{stu_assess_row_number}}{%endraw%}"
      {% endif %}
      # JOIN ADMIN WINDOWS
      - operation: join
        sources:
          - $sources.administration_window_xwalk
        left_keys:
          - assessment_identifier
          - school_year
          - grade_level_code
          - subject
          - administration_window
        right_keys:
          - assessment_identifier
          - school_year
          - grade_level_code
          - subject
          - administration_window
        right_drop_columns:
          - course_abbrev
        join_type: inner 
      # JOIN obj assess descriptive names
      - operation: join
        sources:
          - $sources.obj_assess_codes_xwalk
        left_keys:
          - assessment_identifier
          - school_year
          - subject
          - course_abbrev
        right_keys:
          - assessment_identifier
          - school_year
          - subject
          - course
        join_type: inner
      # FILTER to non-empty stu-assess ids, e.g. if wide record had no reading test, drop the reading rows
      - operation: filter_rows
        query: stu_assess_id != ''
        behavior: include 
      # KEEP conformed columns
      - operation: keep_columns
        columns: {{conformed_columns}}

  
  {% endfor %}  

  # STACK ALL CONFORMED SETS TOGETHER
  stacked_scores:
    source: $transformations.staar_summative_alt_scores_reading
    operations:
      - operation: union
        sources:
          - $transformations.staar_summative_alt_scores_mathematics
          - $transformations.staar_summative_alt_scores_social_studies
          - $transformations.staar_summative_alt_scores_science
        {% if ${API_YEAR} <= 2021 %} 
          - $transformations.staar_summative_alt_scores_writing
        {% endif %}

  # FINAL STEPS for stu-assess: stu_id_xwalk, api_year
  studentAssessments:
    source: $transformations.stacked_scores
    operations:
      - operation: duplicate_columns
        columns:
          ${STUDENT_ID_NAME}: studentUniqueId
      # add api_year as a passed-in env var
      - operation: add_columns
        columns:
          api_year: ${API_YEAR} #NOTE, this is passed by the user/airflow as an env variable''


destinations:
  studentAssessments:
    source: $transformations.studentAssessments
    template: ../../templates/studentAssessment.jsont
    extension: jsonl
    linearize: True
  assessments:
    source: $sources.assessments
    template: ../../templates/assessments.jsont
    extension: jsonl
    linearize: True
  objectiveAssessments:
    source: $sources.objectiveAssessments
    template: ../../templates/objectiveAssessments.jsont
    extension: jsonl
    linearize: True
  performanceLevelDescriptors:
    source: $sources.performanceLevelDescriptors
    template: ../../templates/performanceLevelDescriptors.jsont
    extension: jsonl
    linearize: True
  assessmentReportingMethodDescriptors:
    source: $sources.assessmentReportingMethodDescriptors
    template: ../../templates/assessmentReportingMethodDescriptors.jsont
    extension: jsonl
    linearize: True
