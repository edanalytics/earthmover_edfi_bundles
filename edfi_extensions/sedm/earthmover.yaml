# See accompanying README.md for details about this file.
version: 2

config:
  log_level: DEBUG
  output_dir: ${OUTPUT_DIR}
  memory_limit: 1GB
  state_file: ${STATE_FILE}
  show_graph: False
  parameter_defaults:
    DESCRIPTOR_NAMESPACE: uri://ed-fi.org

sources:
  # idea_events:
  #   file: ${IDEA_EVENTS_FILE}
  #   header_rows: 1
  # iep_goals:
  #   file: ${IEP_GOALS_FILE}
  #   header_rows: 1
  # iep_service_prescriptions:
  #   file: ${IEP_SERIVCE_PRESCRIPTIONS_FILE}
  #   header_rows: 1
  student_ieps:
    file: ${STUDENT_IEPS_FILE}
    header_rows: 1

  iep_status_descriptors:
    file: ./seeds/iEPStatusDescriptors.csv
    header_rows: 1

transformations:
  student_ieps:
    source: $sources.student_ieps
    operations:
      - operation: snake_case_columns
      - operation: date_format
        columns: 
          - event_date
          - event_begin_date
          - event_end_date
        from_format: "%m/%d/%Y"
        to_format: "%Y-%m-%d"
      - operation: map_values
        column: placement
        mapping:
          ' -none-': ''


destinations:
  # iDEAEvents:
  #   source: $transformations.idea_events
  #   template: ./templates/iDEAEvents.jsont
  #   extension: jsonl
  # iEPGoals:
  #   source: $transformations.iep_goals
  #   template: ./templates/iEPGoals.jsont
  #   extension: jsonl
  # iEPServicePrescriptions:
  #   source: $transformations.iep_service_prescriptions
  #   template: ./templates/iEPServicePrescriptions.jsont
  #   extension: jsonl
  studentIEPs:
    source: $transformations.student_ieps
    template: ./templates/studentIEPs.jsont
    extension: jsonl

  iEPStatusDescriptors:
    source: $sources.iep_status_descriptors
    template: ./templates/descriptors.jsont
    extension: jsonl